# Re-run after reset to save the final index.html again
final_html_path = "/mnt/data/index.html"

final_html_code = """<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìš°ë¦¬ ì§‘ ì²­ì†Œ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
  <style>
    :root {
      --bg: #f9f9f9;
      --text: #333;
      --card: #fff;
      --shadow: rgba(0,0,0,0.08);
      --button: #3a7afe;
      --button-hover: #2f63d3;
    }
    body.dark {
      --bg: #1e1e1e;
      --text: #f0f0f0;
      --card: #2a2a2a;
      --shadow: rgba(255,255,255,0.1);
      --button: #5f9eff;
      --button-hover: #3a7afe;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      transition: background 0.3s, color 0.3s;
    }
    .checklist-container {
      background: var(--card);
      border-radius: 12px;
      box-shadow: 0 0 10px var(--shadow);
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    h2 {
      color: var(--button);
      font-size: 1.5em;
      margin-bottom: 10px;
    }
    form label {
      display: block;
      margin: 10px 0 5px;
    }
    input, select, button {
      padding: 8px;
      margin-top: 5px;
      width: 100%;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      color: #000;
    }
    body.dark input, body.dark select {
      background: #444;
      color: #fff;
      border: 1px solid #666;
    }
    button {
      background-color: var(--button);
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 15px;
    }
    button:hover {
      background-color: var(--button-hover);
    }
    ul {
      padding-left: 20px;
    }
    li {
      margin: 10px 0;
    }
    small {
      color: #888;
      display: block;
      margin-top: 4px;
    }
    .action-buttons button {
      width: 48%;
      margin-right: 2%;
    }
    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    @media (max-width: 480px) {
      .action-buttons button {
        width: 100%;
      }
    }
    .dark-toggle {
      text-align: right;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
<div class="checklist-container">
  <div class="dark-toggle">
    <button onclick="toggleDarkMode()" style="width:auto;">ğŸŒ™ ë‹¤í¬ëª¨ë“œ í† ê¸€</button>
  </div>
  <h2>ìš°ë¦¬ ì§‘ ì²­ì†Œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„±ê¸°</h2>
  <p>ì²­ì†Œ ë£¨í‹´ì„ ë§Œë“¤ê³ , ì™„ë£Œí•˜ë©´ ìë™ ì €ì¥! ë‹¤í¬ëª¨ë“œê¹Œì§€ ì§€ì›í•©ë‹ˆë‹¤.</p>
  <form id="cleaningForm">
    <label>ì£¼ê±° í˜•íƒœ
      <select id="type">
        <option value="ì›ë£¸">ì›ë£¸</option>
        <option value="ì•„íŒŒíŠ¸">ì•„íŒŒíŠ¸</option>
        <option value="ì£¼íƒ">ì£¼íƒ</option>
      </select>
    </label>
    <label>ê±°ì£¼ ì¸ì› ìˆ˜
      <input type="number" id="people" min="1" max="10" value="1" />
    </label>
    <label>
      <input type="checkbox" id="pets" />
      ë°˜ë ¤ë™ë¬¼ ìˆìŒ
    </label>
    <button type="button" onclick="generateChecklist()">ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„±</button>
  </form>
  <div class="action-buttons">
    <button onclick="showTodayTasks()">ì˜¤ëŠ˜ í•  ì¼ë§Œ ë³´ê¸°</button>
    <button onclick="copyChecklist()">ë³µì‚¬</button>
    <button onclick="downloadPDF()">PDF ì €ì¥</button>
  </div>
  <div id="result" style="margin-top: 20px;"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const cleaningIntervals = {
  "ë°”ë‹¥ ì²­ì†Œ": 3,
  "í™”ì¥ì‹¤ ì²­ì†Œ": 7,
  "ì£¼ë°© ì •ë¦¬": 4,
  "ëƒ‰ì¥ê³  ì •ë¦¬": 30,
  "ë°˜ë ¤ë™ë¬¼ í„¸ ì œê±°": 2,
  "ì“°ë ˆê¸°í†µ ë¹„ìš°ê¸°": 2,
  "ì°½ë¬¸ ì²­ì†Œ": 90
};
let latestChecklist = [];

function generateChecklist(filterTodayOnly = false) {
  const people = parseInt(document.getElementById("people").value);
  const pets = document.getElementById("pets").checked;
  let checklistHTML = "<h3>ì²­ì†Œ í•­ëª©</h3><ul>";
  latestChecklist = [];

  function addItem(label) {
    const key = `ì²­ì†Œ_${label}`;
    const lastCleaned = localStorage.getItem(key);
    let nextDateStr = "";
    let showItem = true;

    if (lastCleaned) {
      const lastDate = new Date(lastCleaned);
      const nextDate = new Date(lastDate);
      nextDate.setDate(nextDate.getDate() + cleaningIntervals[label]);
      const todayStr = new Date().toISOString().split('T')[0];
      nextDateStr = nextDate.toISOString().split('T')[0];
      if (filterTodayOnly && nextDateStr !== todayStr) showItem = false;
    }

    if (showItem) {
      latestChecklist.push(`${label} - ë‹¤ìŒ ì²­ì†Œì¼: ${nextDateStr || "ë¯¸ì •"}`);
      checklistHTML += `<li>
        <input type="checkbox" onchange="saveCleaningDate('${label}')" />
        ${label}
        ${nextDateStr ? `<small>â–¶ ë‹¤ìŒ ì²­ì†Œ ì˜ˆì •ì¼: ${nextDateStr}</small>` : ""}
      </li>`;
    }
  }

  addItem("ë°”ë‹¥ ì²­ì†Œ");
  addItem("í™”ì¥ì‹¤ ì²­ì†Œ");
  addItem("ì£¼ë°© ì •ë¦¬");
  addItem("ëƒ‰ì¥ê³  ì •ë¦¬");
  if (pets) addItem("ë°˜ë ¤ë™ë¬¼ í„¸ ì œê±°");
  if (people >= 3) addItem("ì“°ë ˆê¸°í†µ ë¹„ìš°ê¸°");
  addItem("ì°½ë¬¸ ì²­ì†Œ");

  checklistHTML += "</ul>";
  document.getElementById("result").innerHTML = checklistHTML;
}

function saveCleaningDate(task) {
  const today = new Date().toISOString().split('T')[0];
  localStorage.setItem(`ì²­ì†Œ_${task}`, today);
  generateChecklist();
}

function showTodayTasks() {
  generateChecklist(true);
}

function copyChecklist() {
  const text = latestChecklist.join("\\n");
  navigator.clipboard.writeText(text).then(() => {
    alert("ì²´í¬ë¦¬ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
  });
}

function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(12);
  doc.text("ìš°ë¦¬ ì§‘ ì²­ì†Œ ì²´í¬ë¦¬ìŠ¤íŠ¸", 10, 10);
  latestChecklist.forEach((item, i) => {
    doc.text(`- ${item}`, 10, 20 + i * 8);
  });
  doc.save("ì²­ì†Œì²´í¬ë¦¬ìŠ¤íŠ¸.pdf");
}

function toggleDarkMode() {
  document.body.classList.toggle("dark");
}
</script>
</body>
</html>
"""

with open(final_html_path, "w", encoding="utf-8") as f:
    f.write(final_html_code)

final_html_path
